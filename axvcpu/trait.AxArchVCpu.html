<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Architecture-specific virtual CPU trait definition."><title>AxArchVCpu in axvcpu - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-0ce1a80b.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="axvcpu" data-themes="" data-resource-suffix="" data-rustdoc-version="1.89.0-nightly (60dabef95 2025-05-19)" data-channel="nightly" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../static.files/storage-4e99c027.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-7ef8a74a.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../axvcpu/index.html">axvcpu</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">AxArchV<wbr>Cpu</a></h2><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.CreateConfig" title="CreateConfig">CreateConfig</a></li><li><a href="#associatedtype.SetupConfig" title="SetupConfig">SetupConfig</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.bind" title="bind">bind</a></li><li><a href="#tymethod.inject_interrupt" title="inject_interrupt">inject_interrupt</a></li><li><a href="#tymethod.new" title="new">new</a></li><li><a href="#tymethod.run" title="run">run</a></li><li><a href="#tymethod.set_entry" title="set_entry">set_entry</a></li><li><a href="#tymethod.set_ept_root" title="set_ept_root">set_ept_root</a></li><li><a href="#tymethod.set_gpr" title="set_gpr">set_gpr</a></li><li><a href="#tymethod.set_return_value" title="set_return_value">set_return_value</a></li><li><a href="#tymethod.setup" title="setup">setup</a></li><li><a href="#tymethod.unbind" title="unbind">unbind</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate axvcpu</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">axvcpu</a></div><h1>Trait <span class="trait">AxArchVCpu</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/axvcpu/arch_vcpu.rs.html#12-79">Source</a> </span></div><pre class="rust item-decl"><code>pub trait AxArchVCpu: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a> {
    type <a href="#associatedtype.CreateConfig" class="associatedtype">CreateConfig</a>;
    type <a href="#associatedtype.SetupConfig" class="associatedtype">SetupConfig</a>;

    // Required methods
    fn <a href="#tymethod.new" class="fn">new</a>(
        vm_id: VMId,
        vcpu_id: VCpuId,
        config: Self::<a class="associatedtype" href="trait.AxArchVCpu.html#associatedtype.CreateConfig" title="type axvcpu::AxArchVCpu::CreateConfig">CreateConfig</a>,
    ) -&gt; AxResult&lt;Self&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.set_entry" class="fn">set_entry</a>(&amp;mut self, entry: GuestPhysAddr) -&gt; AxResult;
<span class="item-spacer"></span>    fn <a href="#tymethod.set_ept_root" class="fn">set_ept_root</a>(&amp;mut self, ept_root: HostPhysAddr) -&gt; AxResult;
<span class="item-spacer"></span>    fn <a href="#tymethod.setup" class="fn">setup</a>(&amp;mut self, config: Self::<a class="associatedtype" href="trait.AxArchVCpu.html#associatedtype.SetupConfig" title="type axvcpu::AxArchVCpu::SetupConfig">SetupConfig</a>) -&gt; AxResult;
<span class="item-spacer"></span>    fn <a href="#tymethod.run" class="fn">run</a>(&amp;mut self) -&gt; AxResult&lt;<a class="enum" href="enum.AxVCpuExitReason.html" title="enum axvcpu::AxVCpuExitReason">AxVCpuExitReason</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.bind" class="fn">bind</a>(&amp;mut self) -&gt; AxResult;
<span class="item-spacer"></span>    fn <a href="#tymethod.unbind" class="fn">unbind</a>(&amp;mut self) -&gt; AxResult;
<span class="item-spacer"></span>    fn <a href="#tymethod.set_gpr" class="fn">set_gpr</a>(&amp;mut self, reg: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.inject_interrupt" class="fn">inject_interrupt</a>(&amp;mut self, vector: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; AxResult;
<span class="item-spacer"></span>    fn <a href="#tymethod.set_return_value" class="fn">set_return_value</a>(&amp;mut self, val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>);
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Architecture-specific virtual CPU trait definition.</p>
<p>This trait provides an abstraction layer for implementing virtual CPUs across
different hardware architectures (x86_64, ARM64, RISC-V, etc.). Each architecture
must implement this trait to provide the necessary low-level virtualization primitives.</p>
</div></details><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><details class="toggle" open><summary><section id="associatedtype.CreateConfig" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#17">Source</a><h4 class="code-header">type <a href="#associatedtype.CreateConfig" class="associatedtype">CreateConfig</a></h4></section></summary><div class="docblock"><p>Architecture-specific configuration for VCpu creation.</p>
<p>This associated type allows each architecture to define its own
configuration parameters needed during VCpu initialization.</p>
</div></details><details class="toggle" open><summary><section id="associatedtype.SetupConfig" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#23">Source</a><h4 class="code-header">type <a href="#associatedtype.SetupConfig" class="associatedtype">SetupConfig</a></h4></section></summary><div class="docblock"><p>Architecture-specific configuration for VCpu setup.</p>
<p>This associated type allows each architecture to specify additional
configuration parameters needed after basic VCpu creation but before execution.</p>
</div></details></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.new" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#26">Source</a><h4 class="code-header">fn <a href="#tymethod.new" class="fn">new</a>(
    vm_id: VMId,
    vcpu_id: VCpuId,
    config: Self::<a class="associatedtype" href="trait.AxArchVCpu.html#associatedtype.CreateConfig" title="type axvcpu::AxArchVCpu::CreateConfig">CreateConfig</a>,
) -&gt; AxResult&lt;Self&gt;</h4></section></summary><div class="docblock"><p>Creates a new architecture-specific VCpu instance.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.set_entry" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#31">Source</a><h4 class="code-header">fn <a href="#tymethod.set_entry" class="fn">set_entry</a>(&amp;mut self, entry: GuestPhysAddr) -&gt; AxResult</h4></section></summary><div class="docblock"><p>Sets the guest entry point where VCpu execution will begin.</p>
<p>It’s guaranteed that this function is called only once, before <a href="trait.AxArchVCpu.html#tymethod.setup" title="method axvcpu::AxArchVCpu::setup"><code>AxArchVCpu::setup</code></a> being called.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.set_ept_root" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#37">Source</a><h4 class="code-header">fn <a href="#tymethod.set_ept_root" class="fn">set_ept_root</a>(&amp;mut self, ept_root: HostPhysAddr) -&gt; AxResult</h4></section></summary><div class="docblock"><p>Sets the Extended Page Table (EPT) root for memory translation.</p>
<p>The EPT root defines the top-level page table used for guest-to-host
physical address translation in hardware virtualization.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.setup" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#43">Source</a><h4 class="code-header">fn <a href="#tymethod.setup" class="fn">setup</a>(&amp;mut self, config: Self::<a class="associatedtype" href="trait.AxArchVCpu.html#associatedtype.SetupConfig" title="type axvcpu::AxArchVCpu::SetupConfig">SetupConfig</a>) -&gt; AxResult</h4></section></summary><div class="docblock"><p>Completes VCpu initialization and prepares it for execution.</p>
<p>This method performs any final architecture-specific setup needed
before the VCpu can be bound and executed.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.run" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#50">Source</a><h4 class="code-header">fn <a href="#tymethod.run" class="fn">run</a>(&amp;mut self) -&gt; AxResult&lt;<a class="enum" href="enum.AxVCpuExitReason.html" title="enum axvcpu::AxVCpuExitReason">AxVCpuExitReason</a>&gt;</h4></section></summary><div class="docblock"><p>Executes the VCpu until a VM exit occurs.</p>
<p>This is the core execution method that transfers control to the guest VCpu
and runs until the guest triggers a VM exit condition that requires
hypervisor intervention.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.bind" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#56">Source</a><h4 class="code-header">fn <a href="#tymethod.bind" class="fn">bind</a>(&amp;mut self) -&gt; AxResult</h4></section></summary><div class="docblock"><p>Binds the VCpu to the current physical CPU for execution.</p>
<p>This method performs any necessary architecture-specific initialization
to prepare the VCpu for execution on the current physical CPU.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.unbind" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#62">Source</a><h4 class="code-header">fn <a href="#tymethod.unbind" class="fn">unbind</a>(&amp;mut self) -&gt; AxResult</h4></section></summary><div class="docblock"><p>Unbinds the VCpu from the current physical CPU.</p>
<p>This method performs cleanup and state preservation when moving
the VCpu away from the current physical CPU.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.set_gpr" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#65">Source</a><h4 class="code-header">fn <a href="#tymethod.set_gpr" class="fn">set_gpr</a>(&amp;mut self, reg: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Sets the value of a general-purpose register.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.inject_interrupt" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#75">Source</a><h4 class="code-header">fn <a href="#tymethod.inject_interrupt" class="fn">inject_interrupt</a>(&amp;mut self, vector: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>) -&gt; AxResult</h4></section></summary><div class="docblock"><p>Inject an interrupt to the VCpu.</p>
<p>It’s guaranteed (for implementors, and required for callers) that this function is called
on the physical CPU where the VCpu is running or queueing.</p>
<p>It’s not guaranteed that the VCpu is running or bound to the current physical CPU when this
function is called. It means sometimes an irq queue is necessary to buffer the interrupts
until the VCpu is running.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.set_return_value" class="method"><a class="src rightside" href="../src/axvcpu/arch_vcpu.rs.html#78">Source</a><h4 class="code-header">fn <a href="#tymethod.set_return_value" class="fn">set_return_value</a>(&amp;mut self, val: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Sets the return value that will be delivered to the guest.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#dyn-compatibility">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../trait.impl/axvcpu/arch_vcpu/trait.AxArchVCpu.js" async></script></section></div></main></body></html>